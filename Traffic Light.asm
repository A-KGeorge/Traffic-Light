CODE:
.INCLUDE "M32DEF.INC"
//Main red = LED 0
//Main amber = LED 1
//Main green = LED 2
//Side red = LED 5
//Side amber = LED 6
//Side green = LED 7
.EQU MAINGO = 0b11000011
.EQU MAINAMBER = 0b10000101
.EQU SIDEGO = 0b01100110
.EQU SIDEAMBER = 0b10100100
.DEF LIGHTS = R22
.DEF DELAYREG20 = R23
.DEF DELAYREG40 = R24

LDI R19, LOW(RAMEND)
OUT SPL, R19
LDI R19, HIGH(RAMEND)
OUT SPH, R19
LDI R21,0b11100111
OUT DDRD,R21//setting PORTS D0,D1,D2,D5,D6,D7 as output

MAIN:LDI DELAYREG20, 0xA
	 LDI DELAYREG40, 0x14

LOOP1:LDI LIGHTS,MAINGO
	  OUT PORTD, LIGHTS
      CALL DELAY
	  DEC DELAYREG40
	  BRNE LOOP1

LOOP2:LDI LIGHTS,MAINAMBER
	  OUT PORTD, LIGHTS
      CALL DELAY

LOOP3:LDI LIGHTS,SIDEGO
	  OUT PORTD, LIGHTS
	  CALL DELAY
	  DEC DELAYREG20
	  BRNE LOOP3

LOOP4:LDI LIGHTS,SIDEAMBER
	  OUT PORTD, LIGHTS
      CALL DELAY
	  JMP MAIN

Delay:
	LDI R17, 0XF8
	OUT TCNT1H, R17
	LDI R17, 0x5F
	OUT TCNT1L, R17
	LDI R18, 0B00000000
	OUT TCCR1A, R18
	LDI R18, 0B00000101
	OUT TCCR1B, R18

AGAIN: 
	IN R20, TIFR
	SBRS R20, 2
	RJMP AGAIN
	LDI R20, 0x04
	OUT TIFR, R20
	LDI R16, 0x0
	OUT TCCR1A, R16
	OUT TCCR1B, R16
	RET
